"use client"
var y=(t=>(t.RELOAD="devtools:reload",t.DEVTOOLS_INIT="devtools:init",t.DEVTOOLS_HANDSHAKE="devtools:handshake",t.DEVTOOLS_ALREADY_CONNECTED="devtools:already-connected",t.ACTIVITY="devtools:send-activity",t.DEVTOOLS_ACTIVITY_UPDATE="devtools:activity-update",t.DEVTOOLS_CONNECTED_APP="devtools:connected-app",t.DEVTOOLS_DISCONNECTED_APP="devtools:disconnected-app",t.DEVTOOLS_HIGHLIGHT_IN_MONITOR="devtools:highlight-in-monitor",t.DEVTOOLS_HIGHLIGHT_IN_MONITOR_ACTION="devtools:highlight-in-monitor-action",t.DEVTOOLS_LOGIN_SUCCESS="devtools:login-success",t.DEVTOOLS_DISPLAY_LOGIN_FAILURE="devtools:display-login-failure",t.DEVTOOLS_LOGIN_FAILURE="devtools:login-failure",t.DEVTOOLS_RELOAD_AFTER_LOGIN="devtools:reload-after-login",t.DEVTOOLS_INVALIDATE_QUERY="devtools:invalidate-query",t.DEVTOOLS_INVALIDATE_QUERY_ACTION="devtools:invalidate-query-action",t))(y||{});var E={useCan:"access-control",useLog:"audit-log",useLogList:"audit-log",useCreate:"data",useCreateMany:"data",useCustom:"data",useCustomMutation:"data",useDelete:"data",useDeleteMany:"data",useInfiniteList:"data",useList:"data",useMany:"data",useOne:"data",useUpdate:"data",useUpdateMany:"data",useForgotPassword:"auth",useGetIdentity:"auth",useIsAuthenticated:"auth",useLogin:"auth",useLogout:"auth",useOnError:"auth",usePermissions:"auth",useRegister:"auth",useUpdatePassword:"auth"},_=Object.entries(E).reduce((e,[a,o])=>(e[o]||(e[o]=[]),e[o].push(a),e),{});import i from"react";async function O(e,a,o){if(e.readyState!==e.OPEN){await new Promise(s=>{let r=()=>{e.send(JSON.stringify({event:a,payload:o})),s(),e.removeEventListener("open",r)};e.addEventListener("open",r)});return}e.send(JSON.stringify({event:a,payload:o}))}function T(e,a,o){let s=r=>{let{event:u,payload:l}=JSON.parse(r.data);a===u&&o(l)};return e.addEventListener("message",s),()=>{e.removeEventListener("message",s)}}var v=i.createContext({__devtools:!1,port:5001,url:"localhost",secure:!1,ws:null}),S=({__devtools:e,port:a,children:o})=>{let[s,r]=i.useState({__devtools:e??!1,port:a??5001,url:"localhost",secure:!1,ws:null,devtoolsUrl:"http://localhost:5001"}),[u,l]=i.useState(null);i.useEffect(()=>{let d=null,n=new WebSocket(`${s.secure?"wss":"ws"}://localhost:${s.port}`),c=T(n,"devtools:handshake",D=>{r(L=>({...L,devtoolsUrl:D.url})),c()});return n.addEventListener("open",()=>{s.__devtools||(d=setTimeout(()=>{O(n,"devtools:init",{url:window.location.origin})},300))}),l(n),()=>{c(),d&&clearTimeout(d),n.readyState===WebSocket.CONNECTING?n.addEventListener("open",()=>{n.close(1e3,window.location.origin)}):n.close(1e3,window.location.origin)}},[]);let p=i.useMemo(()=>({...s,ws:u}),[s,u]);return i.createElement(v.Provider,{value:p},o)};export{v as DevToolsContext,S as DevToolsContextProvider,y as DevtoolsEvent,_ as hooksByScope,T as receive,E as scopes,O as send};
//# sourceMappingURL=index.mjs.map